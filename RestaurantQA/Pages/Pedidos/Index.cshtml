@page
@using Restaurant.Entities
@model Restaurant.Pages.Pedidos.PedidosModel
@{
    ViewData["Title"] = "Gestión de Pedidos";
}

<h2>Crear Pedido</h2>

<form method="post">
    <div class="mb-2">
        <label>Cliente</label>
        <select asp-for="Pedido.ClienteId" class="form-control">
            <option value="">-- Seleccionar cliente --</option>
            @foreach (var c in Model.Clientes)
            {
                <option value="@c.Id">@c.Nombre @c.Apellido</option>
            }
        </select>
        <br>
        <text>¿Registrar un nuevo cliente?</text>
        <a asp-page="../Clientes/Create" class="btn btn-success btn-sm">Registrar</a>
    </div>

    <div class="mb-2">
        <label>Productos</label>
        <table class="table">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Precio</th>
                    <th>Stock</th>
                    <th>Cantidad</th>
                </tr>
            </thead>
            <tbody>
            @for (int i = 0; i < Model.Productos.Count(); i++)
            {
                <tr>
                    <td>@Model.Productos.ElementAt(i).Nombre</td>
                    <td>@Model.Productos.ElementAt(i).Precio</td>
                    <td>@Model.Productos.ElementAt(i).Stock</td>
                    <td>
                        <input type="number" name="Cantidades[@i]" value="0" class="form-control" min="0" />
                        <input type="hidden" name="ProductoIds[@i]" value="@Model.Productos.ElementAt(i).Id" />
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>

    <button type="submit" class="btn btn-primary mt-2">Crear Pedido</button>
</form>

<hr />

<a asp-page="./List" class="btn btn-outline-primary">Ver lista de pedidos</a>
